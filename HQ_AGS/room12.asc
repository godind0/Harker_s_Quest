// room script file
bool gameIsStarted = false;
bool gameHasEnded = false;

function room_AfterFadeIn()
{
  int minutesOfTravel;
  
  if(!gameIsStarted)
  {
    musicFirstSetup(aIntrigue);
    gameIsStarted = true;
  }  
  
  if(getTravellingBool())
  {
    minutesOfTravel = travelDestinationTimeInMinutes(getCurrentZone(), getWantedDestination());
    addTime(0, minutesOfTravel, 0, 0);
    
    player.Say("Oh no!");
    player.Say(isThisPlaceOpened(getCommerceType(getWantedDestination())));
    if(getRealDestination() == getCurrentZone())
    {
      player.Say("I guess I'll just go back to where I came from");
    } else if (getRealDestination() == JonathanApt)
    {
      player.Say("I guess I'll just go home");
    } else
    {
      player.Say("I guess I'll just go back to the train station");
    }
    travel(getRealDestination());
  }
  
  if(getStoryBeat() == LondonComplete)
  {
    show_book_gui("GAME CREDITS");
    gameHasEnded = true;
  }
}

function room_Load()
{
  
}

function room_RepExec()
{
  if(getStoryBeat() == LondonComplete && gameHasEnded && !gBook.Visible)
  {
    lblGameOver_title.Text = "Jonathan made it!";
    gameIsOver("Jonathan is headed to Transylvania![Congratulations?");
  }
  if(gBook.Visible)
  {
    gDark.Transparency = 30;
  } else
  {
    gDark.Transparency = 100;
  }
}
